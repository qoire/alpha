
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-23654340-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Tutorial 1: Snake Part 1 &mdash; serge 0.4.1.3 documentation</title>
    
    <link rel="stylesheet" href="_static/pp.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.4.1.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="serge 0.4.1.3 documentation" href="index.html" />
    <link rel="up" title="Tutorials" href="tutorial.html" />
    <link rel="next" title="Tutorial 2: Snake Part 2" href="tutorial-2.html" />
    <link rel="prev" title="Tutorials" href="tutorial.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body>
<div class="header">
  <div class="logo">
    <a href="index.html">
      <img class="logo" src="_static/pyramid_text.png" alt="Logo"/>
    </a>
  </div>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tutorial-2.html" title="Tutorial 2: Snake Part 2"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorials"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">serge 0.4.1.3 documentation</a> &raquo;</li>
          <li><a href="tutorial.html" accesskey="U">Tutorials</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tutorial-1-snake-part-1">
<h1><a class="toc-backref" href="#id1">Tutorial 1: Snake Part 1</a><a class="headerlink" href="#tutorial-1-snake-part-1" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#tutorial-1-snake-part-1" id="id1">Tutorial 1: Snake Part 1</a><ul>
<li><a class="reference internal" href="#introduction" id="id2">Introduction</a></li>
<li><a class="reference internal" href="#game" id="id3">Game</a></li>
<li><a class="reference internal" href="#engine-overview" id="id4">Engine Overview</a></li>
<li><a class="reference internal" href="#setting-things-up-quickly" id="id5">Setting Things Up Quickly</a></li>
<li><a class="reference internal" href="#adding-the-snake-s-head" id="id6">Adding The Snake&#8217;s Head</a></li>
<li><a class="reference internal" href="#moving-the-head" id="id7">Moving The Head</a></li>
<li><a class="reference internal" href="#interacting-with-the-snake" id="id8">Interacting With The Snake</a></li>
<li><a class="reference internal" href="#leaving-a-trail" id="id9">Leaving A Trail</a></li>
<li><a class="reference internal" href="#hitting-the-body" id="id10">Hitting The Body</a></li>
<li><a class="reference internal" href="#restarting-the-game" id="id11">Restarting The Game</a></li>
<li><a class="reference internal" href="#minor-polishing" id="id12">Minor Polishing</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id2">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial we will explore some of the basic features of serge. We will
cover <a class="reference internal" href="world.html"><em>Worlds</em></a>, <a class="reference internal" href="zone.html"><em>Zones</em></a>, and <a class="reference internal" href="actor.html"><em>Actors</em></a> using a simple snake game as
an example.</p>
<p>The code for the game is presented as a single file and at each stage the entire code is show. You can simply
copy the code sample into one file and then execute it to run the game. As we add graphics and sounds you will need
to download the game assets. You can download a ZIP file here. This contains the folders and files needed.</p>
</div>
<div class="section" id="game">
<h2><a class="toc-backref" href="#id3">Game</a><a class="headerlink" href="#game" title="Permalink to this headline">¶</a></h2>
<p>The game we will be building is a simple Snake game. In this game you control
an ever growing snake. You turn the snake head left and right and try to avoid
the head hitting the rest of the body.</p>
<p>We are going to start building the game with simple graphics and then, when
the core game is working we will build in sprites, sounds, and fonts to
make it look more attractive.</p>
</div>
<div class="section" id="engine-overview">
<h2><a class="toc-backref" href="#id4">Engine Overview</a><a class="headerlink" href="#engine-overview" title="Permalink to this headline">¶</a></h2>
<p>The basic structure of a serge game revolves around the main <a class="reference internal" href="engine.html"><em>Engine</em></a>.
The engine runs the game.</p>
<p>Most of what happens in a game, the logic etc, is controlled by various actors.
Actors live in worlds and worlds are divided into zones. Actors have visuals which
are how they appear to the player.</p>
<p>Finally, the engine has a renderer, which handles drawing the actor&#8217;s visuals to the screen.
Rendering happens on one or more layers. This allows you to control which actors are painted
in front of which, eg to put the player in front of the background.</p>
<p class="graphviz">
<img src="_images/graphviz-e2e822b8a37c9284baaff76adbf1821ec6eb1438.png" alt="digraph foo {
    engine -&gt; world [label=&quot;∞&quot;];
    world -&gt; zone [label=&quot;∞&quot;];
    zone -&gt; actor [label=&quot;∞&quot;];
    actor -&gt; visual [label=&quot;1&quot;];
    engine -&gt; renderer [label=&quot;1&quot;];
    renderer -&gt; layer [label=&quot;∞&quot;];
    engine -&gt; mouse [label=&quot;1&quot;];
    engine -&gt; keyboard [label=&quot;1&quot;];
}" />
</p>
</div>
<div class="section" id="setting-things-up-quickly">
<h2><a class="toc-backref" href="#id5">Setting Things Up Quickly</a><a class="headerlink" href="#setting-things-up-quickly" title="Permalink to this headline">¶</a></h2>
<p>You have a fair amount of flexibility in how you configure your engine, but for this
example we will use a simple default setup which includes,</p>
<ul class="simple">
<li>a single world, called <em>lab</em>, with a single zone</li>
<li>three rendering layers (called <em>back</em>, <em>middle</em> and <em>front</em>)</li>
</ul>
<p>Here is the code:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">serge.blocks.utils</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>When you run this you should see some logging appear in the console and then a blank window
will appear.</p>
<p>The <em>getSimpleSetup</em> call returns an engine which will render to a screen of size 800x600. The
call to <em>engine.run</em> then runs the engine at 60 frames per second.</p>
</div>
<div class="section" id="adding-the-snake-s-head">
<h2><a class="toc-backref" href="#id6">Adding The Snake&#8217;s Head</a><a class="headerlink" href="#adding-the-snake-s-head" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="_static/ss-1-circle.png"><img alt="_images/ss-1-circle.png" class="align-right" src="_images/ss-1-circle.png" style="width: 200px;" /></a>
<p>Ok, let&#8217;s now add the head of the snake. There will be a fail amount of logic associated
with the snake so we normally want to encapsulate this in an actor. To begin with we
will create the head as a simple circle using the following code.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">serge.actor</span>
<span class="kn">import</span> <span class="nn">serge.blocks.visualblocks</span>
<span class="kn">import</span> <span class="nn">serge.blocks.utils</span>

<span class="k">class</span> <span class="nc">Snake</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents the snake&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;snake&#39;</span><span class="p">,</span> <span class="s">&#39;snake-head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>

<span class="c"># Create the engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getWorld</span><span class="p">(</span><span class="s">&#39;lab&#39;</span><span class="p">)</span>

<span class="c"># Create the snake</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
<span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
<span class="n">snake</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Run the game</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>When you run this you should see a green circle in the middle of the screen. This is the snakes
head. The graphic comes from the line:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<p>This sets the visual representation of the actor to be a green circle with a radius of 16 pixels.
Later on we will replace this with a sprite but for now let&#8217;s keep it simple.</p>
</div>
<div class="section" id="moving-the-head">
<h2><a class="toc-backref" href="#id7">Moving The Head</a><a class="headerlink" href="#moving-the-head" title="Permalink to this headline">¶</a></h2>
<p>Now it is time to move the snake&#8217;s head.</p>
<p>The engine will call the <em>updateActor</em> method on an actors in the currently active world every
timestep. This is the normal way that we perform any game logic and so we will use it to move
the snake.</p>
<p>We need to give the snake a certain direction, which we set up in the <em>__init__</em> method. There
is a <em>block</em> that we can make use of for cardinal directions.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">serge.actor</span>
<span class="kn">import</span> <span class="nn">serge.blocks.visualblocks</span>
<span class="kn">import</span> <span class="nn">serge.blocks.utils</span>
<span class="hll"><span class="kn">import</span> <span class="nn">serge.blocks.directions</span>
</span>
<span class="k">class</span> <span class="nc">Snake</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents the snake&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;snake&#39;</span><span class="p">,</span> <span class="s">&#39;snake-head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
<span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
</span>
<span class="hll">    <span class="k">def</span> <span class="nf">updateActor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
</span><span class="hll">        <span class="sd">&quot;&quot;&quot;Update the snake&quot;&quot;&quot;</span>
</span><span class="hll">        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">updateActor</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
</span><span class="hll">        <span class="c">#</span>
</span><span class="hll">        <span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getVectorFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">offset</span><span class="p">)</span>
</span>
<span class="c"># Create the engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getWorld</span><span class="p">(</span><span class="s">&#39;lab&#39;</span><span class="p">)</span>

<span class="c"># Create the snake</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
<span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
<span class="n">snake</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Run the game</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Now the snake&#8217;s head should gradually move up the screen. This is going <em>north</em> because we
chose this as the current direction in the <em>__init__</em> method. The <em>getVectorFromCardinal</em> function
returns a <em>Vec2d</em> so we can multiply it by any constant to create the right length. You can
experiment with the number 5 to adjust the difficulty of the game.</p>
<p><strong>Note</strong> Always remember to call the base class methods (ie using <em>super</em>) for methods like <em>updateActor</em>.</p>
</div>
<div class="section" id="interacting-with-the-snake">
<h2><a class="toc-backref" href="#id8">Interacting With The Snake</a><a class="headerlink" href="#interacting-with-the-snake" title="Permalink to this headline">¶</a></h2>
<p>So far the snake is just going forward with no input from the user. Let&#8217;s now allow the user to
move the head around. We do this by looking for keyboard input.</p>
<p>The engine has a keyboard object and we can use this to check. Note that for efficiency it is
best to get hold of the keyboard object and anything else you may need in the <em>addedToWorld</em> method
of an actor. This method is called just after the actor is added to the world and is a great
place to do initialisation. It is usually better to do things here rather than in the <em>__init__</em> method
because at <em>__init__</em> you do not know anything about the world you are in.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56</pre></div></td><td class="code"><div class="highlight"><pre><span class="hll"><span class="kn">import</span> <span class="nn">pygame</span>
</span><span class="hll">
</span><span class="hll"><span class="kn">import</span> <span class="nn">serge.engine</span>
</span><span class="kn">import</span> <span class="nn">serge.actor</span>
<span class="kn">import</span> <span class="nn">serge.blocks.visualblocks</span>
<span class="kn">import</span> <span class="nn">serge.blocks.utils</span>
<span class="kn">import</span> <span class="nn">serge.blocks.directions</span>

<span class="k">class</span> <span class="nc">Snake</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents the snake&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;snake&#39;</span><span class="p">,</span> <span class="s">&#39;snake-head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>

<span class="hll">    <span class="k">def</span> <span class="nf">addedToWorld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
</span><span class="hll">        <span class="sd">&quot;&quot;&quot;The snake was added to the world&quot;&quot;&quot;</span>
</span><span class="hll">        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">addedToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">)</span>
</span><span class="hll">        <span class="c">#</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">getKeyboard</span><span class="p">()</span>
</span>
    <span class="k">def</span> <span class="nf">updateActor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">updateActor</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
<span class="hll">        <span class="c">#</span>
</span><span class="hll">        <span class="c"># Move the head</span>
</span><span class="hll">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">):</span>
</span><span class="hll">            <span class="n">rotation</span> <span class="o">=</span> <span class="o">+</span><span class="mi">90</span>
</span><span class="hll">        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">):</span>
</span><span class="hll">            <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
</span><span class="hll">        <span class="k">else</span><span class="p">:</span>
</span><span class="hll">            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class="hll">        <span class="c">#</span>
</span><span class="hll">        <span class="c"># Change direction</span>
</span><span class="hll">        <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
</span><span class="hll">            <span class="n">current_angle</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getAngleFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
</span><span class="hll">            <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getCardinalFromAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
</span>        <span class="c">#</span>
        <span class="c"># Move</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getVectorFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">offset</span><span class="p">)</span>

<span class="c"># Create the engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getWorld</span><span class="p">(</span><span class="s">&#39;lab&#39;</span><span class="p">)</span>

<span class="c"># Create the snake</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
<span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
<span class="n">snake</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Run the game</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>You should now be able to direct the snake&#8217;s head using the left and right arrow keys.
Notice that we use the <em>isClicked</em> method of the keyboard. This means that the user has
to press and release the key before we will turn the snake. We will see later that
we can use the <em>isDown</em> to create a different feel to the game.</p>
</div>
<div class="section" id="leaving-a-trail">
<h2><a class="toc-backref" href="#id9">Leaving A Trail</a><a class="headerlink" href="#leaving-a-trail" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="_static/ss-1-tail.png"><img alt="_images/ss-1-tail.png" class="align-right" src="_images/ss-1-tail.png" style="width: 200px;" /></a>
<p>So far the snake is just a head. Let&#8217;s add a body to it now.</p>
<p>The body of the snake will be made up of a series of segments. We should lay a new
segment down each time we have moved a certain distance. However, we cannot just count
up how far the head has gone since the player may change direction at any time.</p>
<p>So the algorithm is:</p>
<ul class="simple">
<li>Add a new segment to begin with</li>
<li>Each iteration check if adding a new segment would overlap the last</li>
<li>If it overlaps do nothing</li>
<li>It if doesn&#8217;t overlap then add it</li>
</ul>
<p>Let&#8217;s look at the code.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pygame</span>

<span class="kn">import</span> <span class="nn">serge.engine</span>
<span class="kn">import</span> <span class="nn">serge.actor</span>
<span class="kn">import</span> <span class="nn">serge.blocks.visualblocks</span>
<span class="kn">import</span> <span class="nn">serge.blocks.utils</span>
<span class="kn">import</span> <span class="nn">serge.blocks.directions</span>

<span class="hll"><span class="k">class</span> <span class="nc">Snake</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">CompositeActor</span><span class="p">):</span>
</span>    <span class="sd">&quot;&quot;&quot;Represents the snake&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;snake&#39;</span><span class="p">,</span> <span class="s">&#39;snake-head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>

    <span class="k">def</span> <span class="nf">addedToWorld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The snake was added to the world&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">addedToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">getKeyboard</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">updateActor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">updateActor</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Move the head</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">+</span><span class="mi">90</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#</span>
        <span class="c"># Change direction</span>
        <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
            <span class="n">current_angle</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getAngleFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getCardinalFromAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Move</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getVectorFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">offset</span><span class="p">)</span>
<span class="hll">        <span class="c">#</span>
</span><span class="hll">        <span class="c"># Add a new segment if needed</span>
</span><span class="hll">        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
</span><span class="hll">            <span class="bp">self</span><span class="o">.</span><span class="n">addSegment</span><span class="p">()</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">addSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="sd">&quot;&quot;&quot;Add a new body segment&quot;&quot;&quot;</span>
</span><span class="hll">        <span class="n">segment</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;segment&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="n">segment</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
</span><span class="hll">        <span class="n">segment</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="n">segment</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
</span>

<span class="c"># Create the engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getWorld</span><span class="p">(</span><span class="s">&#39;lab&#39;</span><span class="p">)</span>

<span class="c"># Create the snake</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
<span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
<span class="n">snake</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Run the game</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Notice on line 9 we changed the <em>Actor</em> to a <em>CompositeActor</em>. A <em>CompositeActor</em> is just like an actor
but it can have child actors also. This helps keep track of the segments and means that when we add
a segment as a child it will be added to the same world.</p>
<p>We check the distance from the last child using the <em>getDistanceFrom</em> method. You can try different
values than 16 to play around with how the tail looks.</p>
</div>
<div class="section" id="hitting-the-body">
<h2><a class="toc-backref" href="#id10">Hitting The Body</a><a class="headerlink" href="#hitting-the-body" title="Permalink to this headline">¶</a></h2>
<p>So far the game is easy. You can run over the tail as many times as you like. So now let&#8217;s make that
kill the snake.</p>
<p>We can use the <em>getDistanceFrom</em> method of the head to check if it ever collides with a part of the body.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pygame</span>

<span class="kn">import</span> <span class="nn">serge.engine</span>
<span class="kn">import</span> <span class="nn">serge.actor</span>
<span class="kn">import</span> <span class="nn">serge.blocks.visualblocks</span>
<span class="kn">import</span> <span class="nn">serge.blocks.utils</span>
<span class="kn">import</span> <span class="nn">serge.blocks.directions</span>

<span class="k">class</span> <span class="nc">Snake</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">CompositeActor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents the snake&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;snake&#39;</span><span class="p">,</span> <span class="s">&#39;snake-head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>

    <span class="k">def</span> <span class="nf">addedToWorld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The snake was added to the world&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">addedToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">getKeyboard</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">updateActor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">updateActor</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Move the head</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">+</span><span class="mi">90</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#</span>
        <span class="c"># Change direction</span>
        <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
            <span class="n">current_angle</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getAngleFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getCardinalFromAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Move</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getVectorFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">offset</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Add a new segment if needed</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addSegment</span><span class="p">()</span>
<span class="hll">        <span class="c">#</span>
</span><span class="hll">        <span class="c"># Check if we hit the body</span>
</span><span class="hll">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hitBody</span><span class="p">():</span>
</span><span class="hll">            <span class="bp">self</span><span class="o">.</span><span class="n">initiateDeathAnimation</span><span class="p">()</span>
</span>
    <span class="k">def</span> <span class="nf">addSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new body segment&quot;&quot;&quot;</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;segment&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>

<span class="hll">    <span class="k">def</span> <span class="nf">hitBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="sd">&quot;&quot;&quot;Return True if the head has hit the body</span>
</span><span class="hll">
</span><span class="hll"><span class="sd">        Look to see if we overlap with any body segment except the last</span>
</span><span class="hll"><span class="sd">        (we are allowed to overlap the last since we just put it down)</span>
</span><span class="hll">
</span><span class="hll"><span class="sd">        &quot;&quot;&quot;</span>
</span><span class="hll">        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span class="hll">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
</span><span class="hll">                <span class="k">return</span> <span class="bp">True</span>
</span><span class="hll">        <span class="k">return</span> <span class="bp">False</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">initiateDeathAnimation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="sd">&quot;&quot;&quot;Begin showing the death of the snake&quot;&quot;&quot;</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Snake died!&#39;</span><span class="p">)</span>
</span>

<span class="c"># Create the engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getWorld</span><span class="p">(</span><span class="s">&#39;lab&#39;</span><span class="p">)</span>

<span class="c"># Create the snake</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
<span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
<span class="n">snake</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Run the game</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<a class="reference external image-reference" href="_static/ss-1-death.png"><img alt="_images/ss-1-death.png" class="align-right" src="_images/ss-1-death.png" style="width: 200px;" /></a>
<p>Right now the snake actually doesn&#8217;t die it just logs to the console. For the death animation, lets
turn the body red and then gradually remove body parts until we get to the head.</p>
<p>Now for this kind of animation you want it to take a while to show. If you implement this in the
<em>upateActor</em> method then it might happen pretty quickly since that is called 60 times a second.
We can use a timed callback to do this where we can control how often it is called.</p>
<p>Callbacks fall under a category called <em>behaviours</em>. These are generally useful kinds of activities
that can apply to any actors. To utilize <em>behaviours</em> you create a <em>BehaviourManager</em>, which is just
a special actor, and then use it to assign behaviours.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pygame</span>

<span class="kn">import</span> <span class="nn">serge.engine</span>
<span class="kn">import</span> <span class="nn">serge.actor</span>
<span class="kn">import</span> <span class="nn">serge.blocks.visualblocks</span>
<span class="kn">import</span> <span class="nn">serge.blocks.utils</span>
<span class="kn">import</span> <span class="nn">serge.blocks.directions</span>
<span class="kn">import</span> <span class="nn">serge.blocks.behaviours</span>

<span class="k">class</span> <span class="nc">Snake</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">CompositeActor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents the snake&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;snake&#39;</span><span class="p">,</span> <span class="s">&#39;snake-head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
<span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>
</span>
    <span class="k">def</span> <span class="nf">addedToWorld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The snake was added to the world&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">addedToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">getKeyboard</span><span class="p">()</span>
<span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">BehaviourManager</span><span class="p">(</span><span class="s">&#39;manager&#39;</span><span class="p">,</span> <span class="s">&#39;behaviour-manager&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="p">)</span>
</span>
    <span class="k">def</span> <span class="nf">updateActor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">updateActor</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Move the head</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">+</span><span class="mi">90</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#</span>
        <span class="c"># Change direction</span>
        <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
            <span class="n">current_angle</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getAngleFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getCardinalFromAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Move</span>
<span class="hll">        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span><span class="p">:</span>
</span>            <span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getVectorFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">offset</span><span class="p">)</span>
            <span class="c">#</span>
            <span class="c"># Add a new segment if needed</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addSegment</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Check if we hit the body</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hitBody</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initiateDeathAnimation</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">addSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new body segment&quot;&quot;&quot;</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;segment&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">hitBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the head has hit the body</span>

<span class="sd">        Look to see if we overlap with any body segment except the last</span>
<span class="sd">        (we are allowed to overlap the last since we just put it down)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">initiateDeathAnimation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Begin showing the death of the snake&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Snake died!&#39;</span><span class="p">)</span>
<span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">assignBehaviour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span class="hll">            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">TimedCallback</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">removeTail</span><span class="p">),</span> <span class="s">&#39;death-animation&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">True</span>
</span><span class="hll">        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
</span><span class="hll">            <span class="n">segment</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">colour</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">colour</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">removeTail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="n">actor</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
</span><span class="hll">        <span class="sd">&quot;&quot;&quot;Remove part of the tail&quot;&quot;&quot;</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Removing part of the tail&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
</span><span class="hll">            <span class="bp">self</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span class="hll">        <span class="k">else</span><span class="p">:</span>
</span><span class="hll">            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">markComplete</span><span class="p">()</span>
</span>
<span class="c"># Create the engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getWorld</span><span class="p">(</span><span class="s">&#39;lab&#39;</span><span class="p">)</span>

<span class="c"># Create the snake</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
<span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
<span class="n">snake</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Run the game</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>There is a bit of housekeeping we have to do here. On line 19 we create a new property <em>is_dying</em> which we will set
when the snake is dying. When this is true we do not want to move the snake, add bodies or check for death (again) so
we protect some of the lines in the <em>updateActor</em> method to prevent them being called.</p>
<p>The reset of the updates create the <em>manager</em> and then use it to assign the <em>callback</em>. We call the <em>removeTail</em>
method to gradually remove our children. The time interval is set to make sure if takes about a second
to remove the whole tail. When it is done it calls the <em>markComplete</em>
method on the <em>behaviour</em> to tell the engine that it can be discarded as we wont need it again.</p>
</div>
<div class="section" id="restarting-the-game">
<h2><a class="toc-backref" href="#id11">Restarting The Game</a><a class="headerlink" href="#restarting-the-game" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="_static/ss-1-restart.png"><img alt="_images/ss-1-restart.png" class="align-right" src="_images/ss-1-restart.png" style="width: 200px;" /></a>
<p>There isn&#8217;t anything to do after you die now so let&#8217;s add some text and a way to restart.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pygame</span>

<span class="kn">import</span> <span class="nn">serge.engine</span>
<span class="kn">import</span> <span class="nn">serge.actor</span>
<span class="kn">import</span> <span class="nn">serge.blocks.visualblocks</span>
<span class="kn">import</span> <span class="nn">serge.blocks.utils</span>
<span class="kn">import</span> <span class="nn">serge.blocks.directions</span>
<span class="kn">import</span> <span class="nn">serge.blocks.behaviours</span>

<span class="k">class</span> <span class="nc">Snake</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">CompositeActor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents the snake&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;snake&#39;</span><span class="p">,</span> <span class="s">&#39;snake-head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">addedToWorld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The snake was added to the world&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">addedToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">getKeyboard</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">BehaviourManager</span><span class="p">(</span><span class="s">&#39;manager&#39;</span><span class="p">,</span> <span class="s">&#39;behaviour-manager&#39;</span><span class="p">)</span>
        <span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="p">)</span>
        <span class="c">#</span>
<span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;restart&#39;</span><span class="p">,</span>
</span><span class="hll">            <span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s">&#39;Game Over - Press ENTER to restart&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
</span><span class="hll">            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
</span><span class="hll">            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
</span>
    <span class="k">def</span> <span class="nf">updateActor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">updateActor</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Move the head</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">+</span><span class="mi">90</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#</span>
        <span class="c"># Change direction</span>
        <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
            <span class="n">current_angle</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getAngleFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getCardinalFromAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Move</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getVectorFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">offset</span><span class="p">)</span>
            <span class="c">#</span>
            <span class="c"># Add a new segment if needed</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addSegment</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Check if we hit the body</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hitBody</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initiateDeathAnimation</span><span class="p">()</span>
<span class="hll">        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">isComplete</span><span class="p">():</span>
</span><span class="hll">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_KP_ENTER</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RETURN</span><span class="p">):</span>
</span><span class="hll">                <span class="bp">self</span><span class="o">.</span><span class="n">restartGame</span><span class="p">()</span>
</span>
    <span class="k">def</span> <span class="nf">addSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new body segment&quot;&quot;&quot;</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;segment&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">hitBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the head has hit the body</span>

<span class="sd">        Look to see if we overlap with any body segment except the last</span>
<span class="sd">        (we are allowed to overlap the last since we just put it down)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">initiateDeathAnimation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Begin showing the death of the snake&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Snake died!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">assignBehaviour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">TimedCallback</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">removeTail</span><span class="p">),</span> <span class="s">&#39;death-animation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="n">segment</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">colour</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">colour</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">removeTail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="n">actor</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove part of the tail&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Removing part of the tail&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">markComplete</span><span class="p">()</span>
<span class="hll">            <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">True</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">restartGame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="sd">&quot;&quot;&quot;Restart the game&quot;&quot;&quot;</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">colour</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</span>
<span class="c"># Create the engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getWorld</span><span class="p">(</span><span class="s">&#39;lab&#39;</span><span class="p">)</span>

<span class="c"># Create the snake</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
<span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
<span class="n">snake</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Run the game</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>We create some text in the <em>addedToWorld</em> method. Note how we use the <em>front</em> layer to make sure that the text appears
before anything else on the screen. We set the <em>visible</em> property to <em>False</em> initially because we do not want
it to show until the end of the game.</p>
<p>Then in the <em>updateActor</em> method we check for the keypress when we are dying <em>and</em> when the animation has completed.
We do not want to allow the user to press enter before the snake is completely cleaned up.</p>
<p>When the user does press enter then we use the <em>restartGame</em> method to clean up all the flags and this starts
everything over again.</p>
</div>
<div class="section" id="minor-polishing">
<h2><a class="toc-backref" href="#id12">Minor Polishing</a><a class="headerlink" href="#minor-polishing" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="_static/ss-1-polish.png"><img alt="_images/ss-1-polish.png" class="align-right" src="_images/ss-1-polish.png" style="width: 200px;" /></a>
<p>Ok, let&#8217;s take a bit of time polish things up a bit here with a number of changes.</p>
<ul class="simple">
<li>Add a background to the display</li>
<li>Allow the user to press ESCAPE to quit the game at any time</li>
<li>Kill the snake if it goes off the screen</li>
<li>Keep score of how long the user survived</li>
</ul>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pygame</span>

<span class="kn">import</span> <span class="nn">serge.engine</span>
<span class="kn">import</span> <span class="nn">serge.actor</span>
<span class="kn">import</span> <span class="nn">serge.blocks.visualblocks</span>
<span class="kn">import</span> <span class="nn">serge.blocks.utils</span>
<span class="kn">import</span> <span class="nn">serge.blocks.directions</span>
<span class="kn">import</span> <span class="nn">serge.blocks.behaviours</span>
<span class="hll"><span class="kn">import</span> <span class="nn">serge.blocks.actors</span>
</span>
<span class="k">class</span> <span class="nc">Snake</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">CompositeActor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents the snake&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;snake&#39;</span><span class="p">,</span> <span class="s">&#39;snake-head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">addedToWorld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The snake was added to the world&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">addedToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">getKeyboard</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">BehaviourManager</span><span class="p">(</span><span class="s">&#39;manager&#39;</span><span class="p">,</span> <span class="s">&#39;behaviour-manager&#39;</span><span class="p">)</span>
        <span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Text to display when the game is over</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;restart&#39;</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s">&#39;Game Over - Press ENTER to restart&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
<span class="hll">        <span class="c">#</span>
</span><span class="hll">        <span class="c"># A background for the game</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">bg</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;bg&#39;</span><span class="p">,</span> <span class="s">&#39;bg&#39;</span><span class="p">,</span>
</span><span class="hll">            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)),</span>
</span><span class="hll">            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;back&#39;</span><span class="p">,</span>
</span><span class="hll">            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
</span><span class="hll">        <span class="c">#</span>
</span><span class="hll">        <span class="c"># Text to show the score</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span>
</span><span class="hll">            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">actors</span><span class="o">.</span><span class="n">NumericText</span><span class="p">(</span><span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;score&#39;</span><span class="p">,</span> <span class="s">&#39;Score: </span><span class="si">%04d</span><span class="s">&#39;</span><span class="p">,</span>
</span><span class="hll">                <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">),</span>
</span><span class="hll">            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
</span>            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">updateActor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the snake&quot;&quot;&quot;</span>
<span class="hll">        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">updateActor</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
</span><span class="hll">        <span class="c">#</span>
</span><span class="hll">        <span class="c"># Quit if requested</span>
</span><span class="hll">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_ESCAPE</span><span class="p">):</span>
</span>            <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="c">#</span>
        <span class="c"># Move the head</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">+</span><span class="mi">90</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#</span>
        <span class="c"># Change direction</span>
        <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
            <span class="n">current_angle</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getAngleFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getCardinalFromAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Move</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getVectorFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">offset</span><span class="p">)</span>
            <span class="c">#</span>
            <span class="c"># Add a new segment if needed</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addSegment</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Check if we hit the body</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hitBody</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">offScreen</span><span class="p">():</span>
<span class="hll">                <span class="bp">self</span><span class="o">.</span><span class="n">initiateDeathAnimation</span><span class="p">()</span>
</span><span class="hll">            <span class="c">#</span>
</span><span class="hll">            <span class="c"># Increase score</span>
</span>            <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="n">interval</span><span class="o">/</span><span class="mf">1000.0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">isComplete</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_KP_ENTER</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RETURN</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">restartGame</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">addSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new body segment&quot;&quot;&quot;</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;segment&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">hitBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the head has hit the body</span>

<span class="sd">        Look to see if we overlap with any body segment except the last</span>
<span class="sd">        (we are allowed to overlap the last since we just put it down)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>
<span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">offScreen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="sd">&quot;&quot;&quot;Return True if we are off the screen&quot;&quot;&quot;</span>
</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">800</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">600</span>

    <span class="k">def</span> <span class="nf">initiateDeathAnimation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Begin showing the death of the snake&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Snake died!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">assignBehaviour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">TimedCallback</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">removeTail</span><span class="p">),</span> <span class="s">&#39;death-animation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="n">segment</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">colour</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">colour</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">removeTail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="n">actor</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove part of the tail&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Removing part of the tail&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">markComplete</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">restartGame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Restart the game&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">colour</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
</span>        <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Create the engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getWorld</span><span class="p">(</span><span class="s">&#39;lab&#39;</span><span class="p">)</span>

<span class="c"># Create the snake</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
<span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
<span class="n">snake</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Run the game</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>This tutorial continues in <a class="reference internal" href="tutorial-2.html"><em>Tutorial 2: Snake Part 2</em></a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial 1: Snake Part 1</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#game">Game</a></li>
<li><a class="reference internal" href="#engine-overview">Engine Overview</a></li>
<li><a class="reference internal" href="#setting-things-up-quickly">Setting Things Up Quickly</a></li>
<li><a class="reference internal" href="#adding-the-snake-s-head">Adding The Snake&#8217;s Head</a></li>
<li><a class="reference internal" href="#moving-the-head">Moving The Head</a></li>
<li><a class="reference internal" href="#interacting-with-the-snake">Interacting With The Snake</a></li>
<li><a class="reference internal" href="#leaving-a-trail">Leaving A Trail</a></li>
<li><a class="reference internal" href="#hitting-the-body">Hitting The Body</a></li>
<li><a class="reference internal" href="#restarting-the-game">Restarting The Game</a></li>
<li><a class="reference internal" href="#minor-polishing">Minor Polishing</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tutorial.html"
                        title="previous chapter">Tutorials</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tutorial-2.html"
                        title="next chapter">Tutorial 2: Snake Part 2</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tutorial-2.html" title="Tutorial 2: Snake Part 2"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorials"
             >previous</a> |</li>
        <li><a href="index.html">serge 0.4.1.3 documentation</a> &raquo;</li>
          <li><a href="tutorial.html" >Tutorials</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Paul Paterson.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>