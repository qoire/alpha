
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-23654340-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Tutorial 2: Snake Part 2 &mdash; serge 0.4.1.3 documentation</title>
    
    <link rel="stylesheet" href="_static/pp.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.4.1.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="serge 0.4.1.3 documentation" href="index.html" />
    <link rel="up" title="Tutorials" href="tutorial.html" />
    <link rel="next" title="Useful Building Blocks" href="usefulblocks.html" />
    <link rel="prev" title="Tutorial 1: Snake Part 1" href="tutorial-1.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body>
<div class="header">
  <div class="logo">
    <a href="index.html">
      <img class="logo" src="_static/pyramid_text.png" alt="Logo"/>
    </a>
  </div>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="usefulblocks.html" title="Useful Building Blocks"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial-1.html" title="Tutorial 1: Snake Part 1"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">serge 0.4.1.3 documentation</a> &raquo;</li>
          <li><a href="tutorial.html" accesskey="U">Tutorials</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tutorial-2-snake-part-2">
<h1><a class="toc-backref" href="#id1">Tutorial 2: Snake Part 2</a><a class="headerlink" href="#tutorial-2-snake-part-2" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#tutorial-2-snake-part-2" id="id1">Tutorial 2: Snake Part 2</a><ul>
<li><a class="reference internal" href="#adding-sprites" id="id2">Adding Sprites</a></li>
<li><a class="reference internal" href="#adding-sound" id="id3">Adding Sound</a></li>
<li><a class="reference internal" href="#adding-fonts" id="id4">Adding Fonts</a></li>
<li><a class="reference internal" href="#additional-gameplay-elements" id="id5">Additional Gameplay elements</a></li>
<li><a class="reference internal" href="#events" id="id6">Events</a></li>
<li><a class="reference internal" href="#animation" id="id7">Animation</a></li>
<li><a class="reference internal" href="#conclusion" id="id8">Conclusion</a></li>
<li><a class="reference internal" href="#resources" id="id9">Resources</a></li>
<li><a class="reference internal" href="#credits" id="id10">Credits</a></li>
</ul>
</li>
</ul>
</div>
<p>This tutorial continues on from <a class="reference internal" href="tutorial-1.html"><em>Tutorial 1: Snake Part 1</em></a>.</p>
<p>The basic game is in place and we will now add sprites, sound, fonts, animation and events.</p>
<div class="section" id="adding-sprites">
<h2><a class="toc-backref" href="#id2">Adding Sprites</a><a class="headerlink" href="#adding-sprites" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="_static/ss-1-sprites.png"><img alt="_images/ss-1-sprites.png" class="align-right" src="_images/ss-1-sprites.png" style="width: 200px;" /></a>
<p>The game is working ok but we need to add some sprites to start to make it look like a
real game. We will add a sprite for the head and one for the body.</p>
<p>To use sprites with serge you first need to register them in the sprite registry. You can
create simple sprites and animated sprites from single files (sprite sheets) or multiple
files. For the moment let&#8217;s just stick with simple sprites.</p>
<p>To register a sprite you use code like this.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">serge.visual</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;graphics&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">,</span> <span class="s">&#39;head.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;tail&#39;</span><span class="p">,</span> <span class="s">&#39;tail.png&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>It is best to put all sprites in a separate folder. You then use <em>setPath</em> to point serge
at the folder. Then you make repeated calls to <em>registerItem</em> to register each sprite. You
give the sprite a name and the file that you want to use.</p>
<p>Once you have registered a sprite you then use it for an actor&#8217;s visual by calling the <em>setSpriteName</em>
method of the actor. For example.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">snake</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Now the head sprite will be used.</p>
<p>Let&#8217;s add that to our code now. You can download the graphics here (<a class="reference external" href="_static/snake-tutorial.zip">zipfile</a>).</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pygame</span>

<span class="hll"><span class="kn">import</span> <span class="nn">serge.visual</span>
</span><span class="kn">import</span> <span class="nn">serge.engine</span>
<span class="kn">import</span> <span class="nn">serge.actor</span>
<span class="kn">import</span> <span class="nn">serge.blocks.visualblocks</span>
<span class="kn">import</span> <span class="nn">serge.blocks.utils</span>
<span class="kn">import</span> <span class="nn">serge.blocks.directions</span>
<span class="kn">import</span> <span class="nn">serge.blocks.behaviours</span>
<span class="kn">import</span> <span class="nn">serge.blocks.actors</span>

<span class="k">class</span> <span class="nc">Snake</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">CompositeActor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents the snake&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;snake&#39;</span><span class="p">,</span> <span class="s">&#39;snake-head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">)</span>
</span>        <span class="bp">self</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">addedToWorld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The snake was added to the world&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">addedToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">getKeyboard</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">BehaviourManager</span><span class="p">(</span><span class="s">&#39;manager&#39;</span><span class="p">,</span> <span class="s">&#39;behaviour-manager&#39;</span><span class="p">)</span>
        <span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Text to display when the game is over</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;restart&#39;</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s">&#39;Game Over - Press ENTER to restart&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c">#</span>
        <span class="c"># A background for the game</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bg</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;bg&#39;</span><span class="p">,</span> <span class="s">&#39;bg&#39;</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;back&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="c">#</span>
        <span class="c"># Text to show the score</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">actors</span><span class="o">.</span><span class="n">NumericText</span><span class="p">(</span><span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;score&#39;</span><span class="p">,</span> <span class="s">&#39;Score: </span><span class="si">%04d</span><span class="s">&#39;</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">updateActor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">updateActor</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Quit if requested</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_ESCAPE</span><span class="p">):</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="c">#</span>
        <span class="c"># Move the head</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">+</span><span class="mi">90</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#</span>
        <span class="c"># Change direction</span>
        <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
            <span class="n">current_angle</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getAngleFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getCardinalFromAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
<span class="hll">            <span class="bp">self</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">setAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
</span>        <span class="c">#</span>
        <span class="c"># Move</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getVectorFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">offset</span><span class="p">)</span>
            <span class="c">#</span>
            <span class="c"># Add a new segment if needed</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addSegment</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Check if we hit the body</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hitBody</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">offScreen</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initiateDeathAnimation</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Increase score</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="n">interval</span><span class="o">/</span><span class="mf">1000.0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">isComplete</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_KP_ENTER</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RETURN</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">restartGame</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">addSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new body segment&quot;&quot;&quot;</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;segment&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="hll">        <span class="n">segment</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;tail&#39;</span><span class="p">)</span>
</span>        <span class="n">segment</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">hitBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the head has hit the body</span>

<span class="sd">        Look to see if we overlap with any body segment except the last</span>
<span class="sd">        (we are allowed to overlap the last since we just put it down)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">offScreen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if we are off the screen&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">800</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">600</span>

    <span class="k">def</span> <span class="nf">initiateDeathAnimation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Begin showing the death of the snake&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Snake died!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">assignBehaviour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">TimedCallback</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">removeTail</span><span class="p">),</span> <span class="s">&#39;death-animation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
<span class="hll">            <span class="n">segment</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;red-tail&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;red-head&#39;</span><span class="p">)</span>
</span>
    <span class="k">def</span> <span class="nf">removeTail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="n">actor</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove part of the tail&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Removing part of the tail&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">markComplete</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">restartGame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Restart the game&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">)</span>
<span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
</span>        <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Create the engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getWorld</span><span class="p">(</span><span class="s">&#39;lab&#39;</span><span class="p">)</span>

<span class="hll"><span class="c"># Register sprites</span>
</span><span class="hll"><span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;graphics&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">,</span> <span class="s">&#39;head.png&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;tail&#39;</span><span class="p">,</span> <span class="s">&#39;tail.png&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;red-head&#39;</span><span class="p">,</span> <span class="s">&#39;red-head.png&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;red-tail&#39;</span><span class="p">,</span> <span class="s">&#39;red-tail.png&#39;</span><span class="p">)</span>
</span>
<span class="c"># Create the snake</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
<span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
<span class="n">snake</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Run the game</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>We didn&#8217;t have to make too many changes to get this to work. One thing we did do was to create
two sprites to represent the green and red states of the snake. We cannot just change the colour
like we did for the circle. You could create a multi-celled sprite to do this but it is just as
easy to use multiple sprites.</p>
<p>The other thing to notice is that we didn&#8217;t have to make sprites for all the different orientations
of the head. We can just use the <em>setAngle</em> method of the sprite (the actor&#8217;s <em>visual</em>) to rotate
the sprite in the right way.</p>
</div>
<div class="section" id="adding-sound">
<h2><a class="toc-backref" href="#id3">Adding Sound</a><a class="headerlink" href="#adding-sound" title="Permalink to this headline">¶</a></h2>
<p>Sound, like sprites, must be registered before you use it. The process is very similar as it uses
the same underlying <em>registry</em> approach as sprites.</p>
<p>To play a sound you use the following code,</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">serge.sound</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;sounds&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;new-body&#39;</span><span class="p">,</span> <span class="s">&#39;bloop.wav&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s">&#39;new-body&#39;</span><span class="p">)</span>
<span class="c">#</span>
<span class="c"># Or...</span>
<span class="n">my_sound</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="s">&#39;new-body&#39;</span><span class="p">)</span>
<span class="n">my_sound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>In our game we are going to make a sound whenever a new body piece is added and then a different one
when the snake dies. Since we have the death animation, the death sound is quite long. We use the
<em>fadeout</em> method of the sound to make sure that the death sound ends at approximately the same time as
the on-screen animation.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pygame</span>

<span class="kn">import</span> <span class="nn">serge.visual</span>
<span class="hll"><span class="kn">import</span> <span class="nn">serge.sound</span>
</span><span class="kn">import</span> <span class="nn">serge.engine</span>
<span class="kn">import</span> <span class="nn">serge.actor</span>
<span class="kn">import</span> <span class="nn">serge.blocks.visualblocks</span>
<span class="kn">import</span> <span class="nn">serge.blocks.utils</span>
<span class="kn">import</span> <span class="nn">serge.blocks.directions</span>
<span class="kn">import</span> <span class="nn">serge.blocks.behaviours</span>
<span class="kn">import</span> <span class="nn">serge.blocks.actors</span>

<span class="k">class</span> <span class="nc">Snake</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">CompositeActor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents the snake&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;snake&#39;</span><span class="p">,</span> <span class="s">&#39;snake-head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">addedToWorld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The snake was added to the world&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">addedToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">getKeyboard</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">BehaviourManager</span><span class="p">(</span><span class="s">&#39;manager&#39;</span><span class="p">,</span> <span class="s">&#39;behaviour-manager&#39;</span><span class="p">)</span>
        <span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Text to display when the game is over</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;restart&#39;</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s">&#39;Game Over - Press ENTER to restart&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c">#</span>
        <span class="c"># A background for the game</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bg</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;bg&#39;</span><span class="p">,</span> <span class="s">&#39;bg&#39;</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;back&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="c">#</span>
        <span class="c"># Text to show the score</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">actors</span><span class="o">.</span><span class="n">NumericText</span><span class="p">(</span><span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;score&#39;</span><span class="p">,</span> <span class="s">&#39;Score: </span><span class="si">%04d</span><span class="s">&#39;</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">updateActor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">updateActor</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Quit if requested</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_ESCAPE</span><span class="p">):</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="c">#</span>
        <span class="c"># Move the head</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">+</span><span class="mi">90</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#</span>
        <span class="c"># Change direction</span>
        <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
            <span class="n">current_angle</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getAngleFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getCardinalFromAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">setAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Move</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getVectorFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">offset</span><span class="p">)</span>
            <span class="c">#</span>
            <span class="c"># Add a new segment if needed</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addSegment</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Check if we hit the body</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hitBody</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">offScreen</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initiateDeathAnimation</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Increase score</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="n">interval</span><span class="o">/</span><span class="mf">1000.0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">isComplete</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_KP_ENTER</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RETURN</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">restartGame</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">addSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new body segment&quot;&quot;&quot;</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;segment&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;tail&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
<span class="hll">        <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s">&#39;new-body&#39;</span><span class="p">)</span>
</span>
    <span class="k">def</span> <span class="nf">hitBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the head has hit the body</span>

<span class="sd">        Look to see if we overlap with any body segment except the last</span>
<span class="sd">        (we are allowed to overlap the last since we just put it down)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">offScreen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if we are off the screen&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">800</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">600</span>

    <span class="k">def</span> <span class="nf">initiateDeathAnimation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Begin showing the death of the snake&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Snake died!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">assignBehaviour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">TimedCallback</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">removeTail</span><span class="p">),</span> <span class="s">&#39;death-animation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="n">segment</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;red-tail&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;red-head&#39;</span><span class="p">)</span>
<span class="hll">        <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">)</span>
</span>
    <span class="k">def</span> <span class="nf">removeTail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="n">actor</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove part of the tail&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Removing part of the tail&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">markComplete</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">True</span>
<span class="hll">            <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fadeout</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
</span>
    <span class="k">def</span> <span class="nf">restartGame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Restart the game&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Create the engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getWorld</span><span class="p">(</span><span class="s">&#39;lab&#39;</span><span class="p">)</span>

<span class="c"># Register sprites</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;graphics&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">,</span> <span class="s">&#39;head.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;tail&#39;</span><span class="p">,</span> <span class="s">&#39;tail.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;red-head&#39;</span><span class="p">,</span> <span class="s">&#39;red-head.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;red-tail&#39;</span><span class="p">,</span> <span class="s">&#39;red-tail.png&#39;</span><span class="p">)</span>

<span class="hll"><span class="c"># Register sounds</span>
</span><span class="hll"><span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;sounds&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;new-body&#39;</span><span class="p">,</span> <span class="s">&#39;bloop.wav&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">,</span> <span class="s">&#39;death.wav&#39;</span><span class="p">)</span>
</span>
<span class="c"># Create the snake</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
<span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
<span class="n">snake</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Run the game</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="adding-fonts">
<h2><a class="toc-backref" href="#id4">Adding Fonts</a><a class="headerlink" href="#adding-fonts" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="_static/ss-1-fonts.png"><img alt="_images/ss-1-fonts.png" class="align-right" src="_images/ss-1-fonts.png" style="width: 200px;" /></a>
<p>The default fonts in pygame are good but it adds a nice touch to include a custom font. The process for using fonts is very similar to sound and graphics. You need to register the font location, register a font and then you can refer to it subsequently by the registered name.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">serge.visual</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;fonts&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;DEFAULT&#39;</span><span class="p">,</span> <span class="s">&#39;MedievalSharp.ttf&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;scores&#39;</span><span class="p">,</span> <span class="s">&#39;PressStart2P.ttf&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>You for fonts there is also a special name, <em>DEFAULT</em>. If you register a font with this name then this will be the one used by default for all text.</p>
<p>We are using two fonts here, one for the main text and one for the scores. You probably don&#8217;t need to do this in such a simple game but it allows us to see the difference between using the default font and a named font. All classes involving text take some kind of <em>font_name</em> parameter. If you do not pass anything then the default font is used. Alternatively you pass the name of a registered font and it will use that one.</p>
<p>Note that in the updated game we had to move the score text over a bit as the chosen font is larger than the default.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pygame</span>

<span class="kn">import</span> <span class="nn">serge.visual</span>
<span class="kn">import</span> <span class="nn">serge.sound</span>
<span class="kn">import</span> <span class="nn">serge.engine</span>
<span class="kn">import</span> <span class="nn">serge.actor</span>
<span class="kn">import</span> <span class="nn">serge.blocks.visualblocks</span>
<span class="kn">import</span> <span class="nn">serge.blocks.utils</span>
<span class="kn">import</span> <span class="nn">serge.blocks.directions</span>
<span class="kn">import</span> <span class="nn">serge.blocks.behaviours</span>
<span class="kn">import</span> <span class="nn">serge.blocks.actors</span>

<span class="k">class</span> <span class="nc">Snake</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">CompositeActor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents the snake&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;snake&#39;</span><span class="p">,</span> <span class="s">&#39;snake-head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">addedToWorld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The snake was added to the world&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">addedToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">getKeyboard</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">BehaviourManager</span><span class="p">(</span><span class="s">&#39;manager&#39;</span><span class="p">,</span> <span class="s">&#39;behaviour-manager&#39;</span><span class="p">)</span>
        <span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Text to display when the game is over</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;restart&#39;</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s">&#39;Game Over - Press ENTER to restart&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c">#</span>
        <span class="c"># A background for the game</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bg</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;bg&#39;</span><span class="p">,</span> <span class="s">&#39;bg&#39;</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;back&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="c">#</span>
        <span class="c"># Text to show the score</span>
<span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span>
</span><span class="hll">            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">actors</span><span class="o">.</span><span class="n">NumericText</span><span class="p">(</span><span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;score&#39;</span><span class="p">,</span> <span class="s">&#39;Score: </span><span class="si">%04d</span><span class="s">&#39;</span><span class="p">,</span>
</span><span class="hll">                <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s">&#39;scores&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">),</span>
</span><span class="hll">            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
</span><span class="hll">            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
</span>
    <span class="k">def</span> <span class="nf">updateActor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">updateActor</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Quit if requested</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_ESCAPE</span><span class="p">):</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="c">#</span>
        <span class="c"># Move the head</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">+</span><span class="mi">90</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#</span>
        <span class="c"># Change direction</span>
        <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
            <span class="n">current_angle</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getAngleFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getCardinalFromAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">setAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Move</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getVectorFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">offset</span><span class="p">)</span>
            <span class="c">#</span>
            <span class="c"># Add a new segment if needed</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addSegment</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Check if we hit the body</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hitBody</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">offScreen</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initiateDeathAnimation</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Increase score</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="n">interval</span><span class="o">/</span><span class="mf">1000.0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">isComplete</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_KP_ENTER</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RETURN</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">restartGame</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">addSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new body segment&quot;&quot;&quot;</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;segment&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;tail&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
        <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s">&#39;new-body&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">hitBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the head has hit the body</span>

<span class="sd">        Look to see if we overlap with any body segment except the last</span>
<span class="sd">        (we are allowed to overlap the last since we just put it down)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">offScreen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if we are off the screen&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">800</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">600</span>

    <span class="k">def</span> <span class="nf">initiateDeathAnimation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Begin showing the death of the snake&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Snake died!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">assignBehaviour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">TimedCallback</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">removeTail</span><span class="p">),</span> <span class="s">&#39;death-animation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="n">segment</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;red-tail&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;red-head&#39;</span><span class="p">)</span>
        <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">removeTail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="n">actor</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove part of the tail&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Removing part of the tail&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">markComplete</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fadeout</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">restartGame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Restart the game&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Create the engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getWorld</span><span class="p">(</span><span class="s">&#39;lab&#39;</span><span class="p">)</span>

<span class="c"># Register sprites</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;graphics&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">,</span> <span class="s">&#39;head.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;tail&#39;</span><span class="p">,</span> <span class="s">&#39;tail.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;red-head&#39;</span><span class="p">,</span> <span class="s">&#39;red-head.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;red-tail&#39;</span><span class="p">,</span> <span class="s">&#39;red-tail.png&#39;</span><span class="p">)</span>

<span class="c"># Register sounds</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;sounds&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;new-body&#39;</span><span class="p">,</span> <span class="s">&#39;bloop.wav&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">,</span> <span class="s">&#39;death.wav&#39;</span><span class="p">)</span>

<span class="hll"><span class="c"># Register fonts</span>
</span><span class="hll"><span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;fonts&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;DEFAULT&#39;</span><span class="p">,</span> <span class="s">&#39;MedievalSharp.ttf&#39;</span><span class="p">)</span>
</span><span class="hll"><span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;scores&#39;</span><span class="p">,</span> <span class="s">&#39;PressStart2P.ttf&#39;</span><span class="p">)</span>
</span>
<span class="c"># Create the snake</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
<span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
<span class="n">snake</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Run the game</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="additional-gameplay-elements">
<h2><a class="toc-backref" href="#id5">Additional Gameplay elements</a><a class="headerlink" href="#additional-gameplay-elements" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="_static/ss-1-rocks.png"><img alt="_images/ss-1-rocks.png" class="align-right" src="_images/ss-1-rocks.png" style="width: 200px;" /></a>
<p>Before exploring more of the game engine we need to add some more gameplay elements.</p>
<p>Let&#8217;s add a number of rocks to the screen. If the snake hits a rock then it is
going to die. But later we will allow the player to click on the rocks to blow them
up.</p>
<p>First we need to add a rock graphic and then add some code to add it to the screen. We register
the rock graphic as before, with:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">regsiterItem</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">,</span> <span class="s">&#39;rock.png&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Then we will randomly add a rock to the screen every so often in the snakes <em>updateActor</em> method. We also
need to check if the snake has hit a rock. We do this in the same method.</p>
<p>When we add a rock we use the line:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">rock</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The text <em>&#8216;rock&#8217;</em> here is the actor&#8217;s <em>tag</em>. Tags are very useful and can be used to locate groups of actors in the world. In this case we are going to use it to later find out all the rocks that we have added without having to manually keep track.</p>
<p>Every actor has a tag and optionally can have a name. You can also find actors by names but names are assumed (but not forced) to be unique.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">rock</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">,</span> <span class="s">&#39;rock-63&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The new code is as follows.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203</pre></div></td><td class="code"><div class="highlight"><pre><span class="hll"><span class="kn">import</span> <span class="nn">random</span>
</span><span class="kn">import</span> <span class="nn">pygame</span>

<span class="kn">import</span> <span class="nn">serge.visual</span>
<span class="kn">import</span> <span class="nn">serge.sound</span>
<span class="kn">import</span> <span class="nn">serge.engine</span>
<span class="kn">import</span> <span class="nn">serge.actor</span>
<span class="kn">import</span> <span class="nn">serge.blocks.visualblocks</span>
<span class="kn">import</span> <span class="nn">serge.blocks.utils</span>
<span class="kn">import</span> <span class="nn">serge.blocks.directions</span>
<span class="kn">import</span> <span class="nn">serge.blocks.behaviours</span>
<span class="kn">import</span> <span class="nn">serge.blocks.actors</span>

<span class="k">class</span> <span class="nc">Snake</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">CompositeActor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents the snake&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;snake&#39;</span><span class="p">,</span> <span class="s">&#39;snake-head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">addedToWorld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The snake was added to the world&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">addedToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">getKeyboard</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">BehaviourManager</span><span class="p">(</span><span class="s">&#39;manager&#39;</span><span class="p">,</span> <span class="s">&#39;behaviour-manager&#39;</span><span class="p">)</span>
<span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">world</span> <span class="o">=</span> <span class="n">world</span>
</span>        <span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Text to display when the game is over</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;restart&#39;</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s">&#39;Game Over - Press ENTER to restart&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c">#</span>
        <span class="c"># A background for the game</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bg</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;bg&#39;</span><span class="p">,</span> <span class="s">&#39;bg&#39;</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;back&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="c">#</span>
        <span class="c"># Text to show the score</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">actors</span><span class="o">.</span><span class="n">NumericText</span><span class="p">(</span><span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;score&#39;</span><span class="p">,</span> <span class="s">&#39;Score: </span><span class="si">%04d</span><span class="s">&#39;</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s">&#39;scores&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">updateActor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">updateActor</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Quit if requested</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_ESCAPE</span><span class="p">):</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="c">#</span>
        <span class="c"># Move the head</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">+</span><span class="mi">90</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#</span>
        <span class="c"># Change direction</span>
        <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
            <span class="n">current_angle</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getAngleFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getCardinalFromAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">setAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Move</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getVectorFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">offset</span><span class="p">)</span>
<span class="hll">            <span class="c">#</span>
</span><span class="hll">            <span class="c"># Adding random rocks</span>
</span><span class="hll">            <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">:</span>
</span><span class="hll">                <span class="bp">self</span><span class="o">.</span><span class="n">addRock</span><span class="p">()</span>
</span>            <span class="c">#</span>
            <span class="c"># Add a new segment if needed</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addSegment</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Check if we hit the body</span>
<span class="hll">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hitBody</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">offScreen</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hitRock</span><span class="p">():</span>
</span>                <span class="bp">self</span><span class="o">.</span><span class="n">initiateDeathAnimation</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Increase score</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="n">interval</span><span class="o">/</span><span class="mf">1000.0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">isComplete</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_KP_ENTER</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RETURN</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">restartGame</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">addSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new body segment&quot;&quot;&quot;</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;segment&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;tail&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
        <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s">&#39;new-body&#39;</span><span class="p">)</span>

<span class="hll">    <span class="k">def</span> <span class="nf">addRock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="sd">&quot;&quot;&quot;Add a rock to the screen&quot;&quot;&quot;</span>
</span><span class="hll">        <span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">600</span><span class="p">))</span>
</span><span class="hll">        <span class="n">rock</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="n">rock</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="n">rock</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="n">rock</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="o">*</span><span class="n">position</span><span class="p">)</span>
</span><span class="hll">        <span class="n">rock</span><span class="o">.</span><span class="n">setAngle</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">))</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">rock</span><span class="p">)</span>
</span>
    <span class="k">def</span> <span class="nf">hitBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the head has hit the body</span>

<span class="sd">        Look to see if we overlap with any body segment except the last</span>
<span class="sd">        (we are allowed to overlap the last since we just put it down)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="hll">    <span class="k">def</span> <span class="nf">hitRock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="sd">&quot;&quot;&quot;Return True if we hit a rock&quot;&quot;&quot;</span>
</span><span class="hll">        <span class="k">for</span> <span class="n">rock</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">findActorsByTag</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">):</span>
</span><span class="hll">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="n">rock</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
</span><span class="hll">                <span class="k">return</span> <span class="bp">True</span>
</span><span class="hll">        <span class="k">else</span><span class="p">:</span>
</span><span class="hll">            <span class="k">return</span> <span class="bp">False</span>
</span>
    <span class="k">def</span> <span class="nf">offScreen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if we are off the screen&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">800</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">600</span>

    <span class="k">def</span> <span class="nf">initiateDeathAnimation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Begin showing the death of the snake&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Snake died!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">assignBehaviour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">TimedCallback</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">removeTail</span><span class="p">),</span> <span class="s">&#39;death-animation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="n">segment</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;red-tail&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;red-head&#39;</span><span class="p">)</span>
        <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">removeTail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="n">actor</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove part of the tail&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Removing part of the tail&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">markComplete</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fadeout</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">restartGame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Restart the game&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">clearActorsWithTags</span><span class="p">([</span><span class="s">&#39;rock&#39;</span><span class="p">])</span>
</span>

<span class="c"># Create the engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getWorld</span><span class="p">(</span><span class="s">&#39;lab&#39;</span><span class="p">)</span>

<span class="c"># Register sprites</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;graphics&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">,</span> <span class="s">&#39;head.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;tail&#39;</span><span class="p">,</span> <span class="s">&#39;tail.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;red-head&#39;</span><span class="p">,</span> <span class="s">&#39;red-head.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;red-tail&#39;</span><span class="p">,</span> <span class="s">&#39;red-tail.png&#39;</span><span class="p">)</span>
<span class="hll"><span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">,</span> <span class="s">&#39;rock.png&#39;</span><span class="p">)</span>
</span>
<span class="c"># Register sounds</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;sounds&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;new-body&#39;</span><span class="p">,</span> <span class="s">&#39;bloop.wav&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">,</span> <span class="s">&#39;death.wav&#39;</span><span class="p">)</span>

<span class="c"># Register fonts</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;fonts&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;DEFAULT&#39;</span><span class="p">,</span> <span class="s">&#39;MedievalSharp.ttf&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;scores&#39;</span><span class="p">,</span> <span class="s">&#39;PressStart2P.ttf&#39;</span><span class="p">)</span>

<span class="c"># Create the snake</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
<span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
<span class="n">snake</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Run the game</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Some things to note here:</p>
<ul class="simple">
<li>We store the <em>world</em> object in the <em>addActorToWorld</em> as we are going to use this a lot later. This is quite a common requirement and you will find that you often need to do this.</li>
<li>We use the <em>world.findActorsByTags</em> method to locate all the rocks. We didn&#8217;t need to use this for finding the tail segments because we stored these as children. We could have used a similar approach but it is often best not to store lists of actors but just to find them in the world by their tags. If you keep lists of actors hanging around then you need to keep them up to date when actors get added and removed from the world and the world does this anyway so it often isn&#8217;t worth the minor speed improvement to keep the lists yourself.</li>
<li>We again use the tags to help remove all the rocks from the world when we are restarting (<em>world.clearActorsWithTags</em>)</li>
</ul>
</div>
<div class="section" id="events">
<h2><a class="toc-backref" href="#id6">Events</a><a class="headerlink" href="#events" title="Permalink to this headline">¶</a></h2>
<p>Ok, so now we have rocks being added to the screen and we have to dodge them. Let&#8217;s allow the user to blow them up by clicking on them.</p>
<p>To do this we can use the event and notification system. You can link many game events to your own functions to easily react when something happens. In this case we want to do something when the user clicks the mouse on a rock.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">rock</span><span class="o">.</span><span class="n">linkEvent</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">E_LEFT_CLICK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">destroyRock</span><span class="p">,</span> <span class="n">rock</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Our method <em>destroyRock</em>, which we havent&#8217; written yet, will be called whenever the user clicks on a rock. There are many different kinds of events. You can look at these in the <tt class="xref py py-mod docutils literal"><span class="pre">serge.events</span></tt> module. You can be notified when actors are added or removed from the world or when worlds are activated or deactivated. You can even create your own events and use these to trigger actions like starting a new game.</p>
<p>We pass rock as an additional parameter to <em>linkEvent</em> because the event callback (<em>destroyRock</em>) will be called as <em>destroyRock(obj, arg)</em> with <em>obj</em> being the object involved in the event and <em>arg</em> being the final parameter in the <em>linkEvent</em> call. In the case of <em>E_LEFT_CLICK</em> the <em>obj</em> parameter is the <em>mouse</em> object and we really want to know which rock was clicked on so we pass this as the <em>arg</em> parameter.</p>
<p>For some events you do not need this and you can omit the <em>arg</em> parameter.</p>
<p>The new code is below. Try it out and try clicking on the rocks as they appear.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">pygame</span>

<span class="kn">import</span> <span class="nn">serge.visual</span>
<span class="kn">import</span> <span class="nn">serge.sound</span>
<span class="kn">import</span> <span class="nn">serge.engine</span>
<span class="kn">import</span> <span class="nn">serge.actor</span>
<span class="kn">import</span> <span class="nn">serge.blocks.visualblocks</span>
<span class="kn">import</span> <span class="nn">serge.blocks.utils</span>
<span class="kn">import</span> <span class="nn">serge.blocks.directions</span>
<span class="kn">import</span> <span class="nn">serge.blocks.behaviours</span>
<span class="kn">import</span> <span class="nn">serge.blocks.actors</span>

<span class="k">class</span> <span class="nc">Snake</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">CompositeActor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents the snake&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;snake&#39;</span><span class="p">,</span> <span class="s">&#39;snake-head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">addedToWorld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The snake was added to the world&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">addedToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">getKeyboard</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">BehaviourManager</span><span class="p">(</span><span class="s">&#39;manager&#39;</span><span class="p">,</span> <span class="s">&#39;behaviour-manager&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">world</span> <span class="o">=</span> <span class="n">world</span>
        <span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Text to display when the game is over</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;restart&#39;</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s">&#39;Game Over - Press ENTER to restart&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c">#</span>
        <span class="c"># A background for the game</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bg</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;bg&#39;</span><span class="p">,</span> <span class="s">&#39;bg&#39;</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;back&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="c">#</span>
        <span class="c"># Text to show the score</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">actors</span><span class="o">.</span><span class="n">NumericText</span><span class="p">(</span><span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;score&#39;</span><span class="p">,</span> <span class="s">&#39;Score: </span><span class="si">%04d</span><span class="s">&#39;</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s">&#39;scores&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">updateActor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">updateActor</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Quit if requested</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_ESCAPE</span><span class="p">):</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="c">#</span>
        <span class="c"># Move the head</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">+</span><span class="mi">90</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#</span>
        <span class="c"># Change direction</span>
        <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
            <span class="n">current_angle</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getAngleFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getCardinalFromAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">setAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Move</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getVectorFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">offset</span><span class="p">)</span>
            <span class="c">#</span>
            <span class="c"># Adding random rocks</span>
            <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addRock</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Add a new segment if needed</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addSegment</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Check if we hit the body</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hitBody</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">offScreen</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hitRock</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initiateDeathAnimation</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Increase score</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="n">interval</span><span class="o">/</span><span class="mf">1000.0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">isComplete</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_KP_ENTER</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RETURN</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">restartGame</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">addSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new body segment&quot;&quot;&quot;</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;segment&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;tail&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
        <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s">&#39;new-body&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">addRock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a rock to the screen&quot;&quot;&quot;</span>
        <span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">600</span><span class="p">))</span>
        <span class="n">rock</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">)</span>
        <span class="n">rock</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">)</span>
        <span class="n">rock</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="n">rock</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="o">*</span><span class="n">position</span><span class="p">)</span>
        <span class="n">rock</span><span class="o">.</span><span class="n">setAngle</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">))</span>
<span class="hll">        <span class="n">rock</span><span class="o">.</span><span class="n">linkEvent</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">E_LEFT_CLICK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">destroyRock</span><span class="p">,</span> <span class="n">rock</span><span class="p">)</span>
</span>        <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">rock</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">hitBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the head has hit the body</span>

<span class="sd">        Look to see if we overlap with any body segment except the last</span>
<span class="sd">        (we are allowed to overlap the last since we just put it down)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">hitRock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if we hit a rock&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">rock</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">findActorsByTag</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="n">rock</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">offScreen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if we are off the screen&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">800</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">600</span>

    <span class="k">def</span> <span class="nf">initiateDeathAnimation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Begin showing the death of the snake&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Snake died!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">assignBehaviour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">TimedCallback</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">removeTail</span><span class="p">),</span> <span class="s">&#39;death-animation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="n">segment</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;red-tail&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;red-head&#39;</span><span class="p">)</span>
        <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">removeTail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="n">actor</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove part of the tail&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Removing part of the tail&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">markComplete</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fadeout</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>

<span class="hll">    <span class="k">def</span> <span class="nf">destroyRock</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">rock</span><span class="p">):</span>
</span><span class="hll">        <span class="sd">&quot;&quot;&quot;Destroy a rock&quot;&quot;&quot;</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">removeActor</span><span class="p">(</span><span class="n">rock</span><span class="p">)</span>
</span>
    <span class="k">def</span> <span class="nf">restartGame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Restart the game&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">clearActorsWithTags</span><span class="p">([</span><span class="s">&#39;rock&#39;</span><span class="p">])</span>


<span class="c"># Create the engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getWorld</span><span class="p">(</span><span class="s">&#39;lab&#39;</span><span class="p">)</span>

<span class="c"># Register sprites</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;graphics&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">,</span> <span class="s">&#39;head.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;tail&#39;</span><span class="p">,</span> <span class="s">&#39;tail.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;red-head&#39;</span><span class="p">,</span> <span class="s">&#39;red-head.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;red-tail&#39;</span><span class="p">,</span> <span class="s">&#39;red-tail.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">,</span> <span class="s">&#39;rock.png&#39;</span><span class="p">)</span>

<span class="c"># Register sounds</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;sounds&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;new-body&#39;</span><span class="p">,</span> <span class="s">&#39;bloop.wav&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">,</span> <span class="s">&#39;death.wav&#39;</span><span class="p">)</span>

<span class="c"># Register fonts</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;fonts&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;DEFAULT&#39;</span><span class="p">,</span> <span class="s">&#39;MedievalSharp.ttf&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;scores&#39;</span><span class="p">,</span> <span class="s">&#39;PressStart2P.ttf&#39;</span><span class="p">)</span>

<span class="c"># Create the snake</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
<span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
<span class="n">snake</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Run the game</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="animation">
<h2><a class="toc-backref" href="#id7">Animation</a><a class="headerlink" href="#animation" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="_static/ss-1-explode.png"><img alt="_images/ss-1-explode.png" class="align-right" src="_images/ss-1-explode.png" style="width: 200px;" /></a>
<p>Clicking on the rock makes it go away but it doesn&#8217;t really feel like it is exploding. Let&#8217;s add a bit of animation to that by having an explosion occur.</p>
<p>Animations are just sprites that have a number of cells. Each cell of the animation will play for a certain length of time and then the animation will move on to the next cell. You can create cells of animation either from a single file or from multiple files. For this example we will use a single file where the cells of animation are arranged horizontally.</p>
<p>Here is our file.</p>
<img alt="_images/explosion.png" src="_images/explosion.png" style="width: 400px;" />
<p>To register this as a sprite we use:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;explosion&#39;</span><span class="p">,</span> <span class="s">&#39;explosion.png&#39;</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
    <span class="n">w</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">running</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">one_direction</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The framerate sets the number of cells that will be displayed per second. We do not want this animation to loop around and we only want it to go in one direction, ie we want it to run to the end of the animation and then stop. This particular graphic is actually quite large so we also use the <em>zoom</em> argument to scale it down a bit.</p>
<p>We want to add the animation to the screen whenever we destroy a rock. There is a useful <em>block</em> called an <em>AnimateThenDie</em> actor that we can use for this purpose. This is an actor that we place in the world and it will run its animation one and then be removed. This actor is ideal for explosions because we just want them to show and then go away. Look in the <em>destroyRock</em> method to see how we use this actor.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">pygame</span>

<span class="kn">import</span> <span class="nn">serge.visual</span>
<span class="kn">import</span> <span class="nn">serge.sound</span>
<span class="kn">import</span> <span class="nn">serge.engine</span>
<span class="kn">import</span> <span class="nn">serge.actor</span>
<span class="kn">import</span> <span class="nn">serge.blocks.visualblocks</span>
<span class="kn">import</span> <span class="nn">serge.blocks.utils</span>
<span class="kn">import</span> <span class="nn">serge.blocks.directions</span>
<span class="kn">import</span> <span class="nn">serge.blocks.behaviours</span>
<span class="kn">import</span> <span class="nn">serge.blocks.actors</span>

<span class="k">class</span> <span class="nc">Snake</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">CompositeActor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents the snake&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialise the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;snake&#39;</span><span class="p">,</span> <span class="s">&#39;snake-head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">addedToWorld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The snake was added to the world&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">addedToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">getKeyboard</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">BehaviourManager</span><span class="p">(</span><span class="s">&#39;manager&#39;</span><span class="p">,</span> <span class="s">&#39;behaviour-manager&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">world</span> <span class="o">=</span> <span class="n">world</span>
        <span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Text to display when the game is over</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;restart&#39;</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s">&#39;Game Over - Press ENTER to restart&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c">#</span>
        <span class="c"># A background for the game</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bg</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addVisualActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span> <span class="s">&#39;bg&#39;</span><span class="p">,</span> <span class="s">&#39;bg&#39;</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">visualblocks</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;back&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
        <span class="c">#</span>
        <span class="c"># Text to show the score</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">addActorToWorld</span><span class="p">(</span><span class="n">world</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">actors</span><span class="o">.</span><span class="n">NumericText</span><span class="p">(</span><span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="s">&#39;score&#39;</span><span class="p">,</span> <span class="s">&#39;Score: </span><span class="si">%04d</span><span class="s">&#39;</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s">&#39;scores&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">),</span>
            <span class="n">layer_name</span><span class="o">=</span><span class="s">&#39;front&#39;</span><span class="p">,</span>
            <span class="n">center_position</span><span class="o">=</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">updateActor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the snake&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Snake</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">updateActor</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Quit if requested</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_ESCAPE</span><span class="p">):</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">CurrentEngine</span><span class="p">()</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="c">#</span>
        <span class="c"># Move the head</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_LEFT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">+</span><span class="mi">90</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RIGHT</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#</span>
        <span class="c"># Change direction</span>
        <span class="k">if</span> <span class="n">rotation</span><span class="p">:</span>
            <span class="n">current_angle</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getAngleFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getCardinalFromAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">setAngle</span><span class="p">(</span><span class="n">current_angle</span><span class="o">+</span><span class="n">rotation</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="c"># Move</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">getVectorFromCardinal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">*</span><span class="n">offset</span><span class="p">)</span>
            <span class="c">#</span>
            <span class="c"># Adding random rocks</span>
            <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addRock</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Add a new segment if needed</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addSegment</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Check if we hit the body</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hitBody</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">offScreen</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hitRock</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initiateDeathAnimation</span><span class="p">()</span>
            <span class="c">#</span>
            <span class="c"># Increase score</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="n">interval</span><span class="o">/</span><span class="mf">1000.0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">isComplete</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_KP_ENTER</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">isClicked</span><span class="p">(</span><span class="n">pygame</span><span class="o">.</span><span class="n">K_RETURN</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">restartGame</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">addSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new body segment&quot;&quot;&quot;</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;segment&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;tail&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="n">segment</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
        <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s">&#39;new-body&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">addRock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a rock to the screen&quot;&quot;&quot;</span>
        <span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">600</span><span class="p">))</span>
        <span class="n">rock</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">Actor</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">)</span>
        <span class="n">rock</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">)</span>
        <span class="n">rock</span><span class="o">.</span><span class="n">setLayerName</span><span class="p">(</span><span class="s">&#39;middle&#39;</span><span class="p">)</span>
        <span class="n">rock</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="o">*</span><span class="n">position</span><span class="p">)</span>
        <span class="n">rock</span><span class="o">.</span><span class="n">setAngle</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">))</span>
        <span class="n">rock</span><span class="o">.</span><span class="n">linkEvent</span><span class="p">(</span><span class="n">serge</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">E_LEFT_CLICK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">destroyRock</span><span class="p">,</span> <span class="n">rock</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">rock</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">hitBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the head has hit the body</span>

<span class="sd">        Look to see if we overlap with any body segment except the last</span>
<span class="sd">        (we are allowed to overlap the last since we just put it down)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">hitRock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if we hit a rock&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">rock</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">findActorsByTag</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDistanceFrom</span><span class="p">(</span><span class="n">rock</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">offScreen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if we are off the screen&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">800</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">600</span>

    <span class="k">def</span> <span class="nf">initiateDeathAnimation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Begin showing the death of the snake&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Snake died!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">animation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">assignBehaviour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">TimedCallback</span><span class="p">(</span><span class="mi">1000</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">removeTail</span><span class="p">),</span> <span class="s">&#39;death-animation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="n">segment</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;red-tail&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;red-head&#39;</span><span class="p">)</span>
        <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">removeTail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="n">actor</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove part of the tail&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Removing part of the tail&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChildren</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">animation</span><span class="o">.</span><span class="n">markComplete</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fadeout</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">destroyRock</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">rock</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Destroy a rock&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">removeActor</span><span class="p">(</span><span class="n">rock</span><span class="p">)</span>
<span class="hll">        <span class="n">explosion</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">actors</span><span class="o">.</span><span class="n">AnimateThenDieActor</span><span class="p">(</span><span class="s">&#39;explosion&#39;</span><span class="p">,</span> <span class="s">&#39;explosion&#39;</span><span class="p">,</span> <span class="s">&#39;explosion&#39;</span><span class="p">,</span> <span class="s">&#39;front&#39;</span><span class="p">)</span>
</span><span class="hll">        <span class="n">explosion</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">rock</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">rock</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">explosion</span><span class="p">)</span>
</span>
    <span class="k">def</span> <span class="nf">restartGame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Restart the game&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_dying</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart_text</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSpriteName</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_direction</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">directions</span><span class="o">.</span><span class="n">N</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">clearActorsWithTags</span><span class="p">([</span><span class="s">&#39;rock&#39;</span><span class="p">])</span>


<span class="c"># Create the engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">serge</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">getSimpleSetup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">getWorld</span><span class="p">(</span><span class="s">&#39;lab&#39;</span><span class="p">)</span>

<span class="c"># Register sprites</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;graphics&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;head&#39;</span><span class="p">,</span> <span class="s">&#39;head.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;tail&#39;</span><span class="p">,</span> <span class="s">&#39;tail.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;red-head&#39;</span><span class="p">,</span> <span class="s">&#39;red-head.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;red-tail&#39;</span><span class="p">,</span> <span class="s">&#39;red-tail.png&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;rock&#39;</span><span class="p">,</span> <span class="s">&#39;rock.png&#39;</span><span class="p">)</span>
<span class="hll"><span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Sprites</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;explosion&#39;</span><span class="p">,</span> <span class="s">&#39;explosion.png&#39;</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
</span><span class="hll">        <span class="n">w</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">running</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">one_direction</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span>
<span class="c"># Register sounds</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;sounds&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;new-body&#39;</span><span class="p">,</span> <span class="s">&#39;bloop.wav&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">Sounds</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;snake-death&#39;</span><span class="p">,</span> <span class="s">&#39;death.wav&#39;</span><span class="p">)</span>

<span class="c"># Register fonts</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">setPath</span><span class="p">(</span><span class="s">&#39;fonts&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;DEFAULT&#39;</span><span class="p">,</span> <span class="s">&#39;MedievalSharp.ttf&#39;</span><span class="p">)</span>
<span class="n">serge</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">Fonts</span><span class="o">.</span><span class="n">registerItem</span><span class="p">(</span><span class="s">&#39;scores&#39;</span><span class="p">,</span> <span class="s">&#39;PressStart2P.ttf&#39;</span><span class="p">)</span>

<span class="c"># Create the snake</span>
<span class="n">snake</span> <span class="o">=</span> <span class="n">Snake</span><span class="p">()</span>
<span class="n">world</span><span class="o">.</span><span class="n">addActor</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
<span class="n">snake</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c"># Run the game</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="conclusion">
<h2><a class="toc-backref" href="#id8">Conclusion</a><a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>This concludes the snake tutorial. We have the basics of a playable game and covered the main fundamental concepts. We covered the following classes - take a look at their detailed documentation.</p>
<ul class="simple">
<li><a class="reference internal" href="engine.html#module-engine" title="engine"><tt class="xref py py-mod docutils literal"><span class="pre">The</span> <span class="pre">Engine</span></tt></a></li>
<li><a class="reference internal" href="world.html#module-world" title="world"><tt class="xref py py-mod docutils literal"><span class="pre">Worlds</span></tt></a></li>
<li><a class="reference internal" href="actor.html#module-actor" title="actor"><tt class="xref py py-mod docutils literal"><span class="pre">Actors</span></tt></a></li>
<li><a class="reference internal" href="visual.html#module-visual" title="visual"><tt class="xref py py-mod docutils literal"><span class="pre">Sprites</span></tt></a></li>
<li><a class="reference internal" href="sound.html#module-sound" title="sound"><tt class="xref py py-mod docutils literal"><span class="pre">Sound</span></tt></a></li>
<li><a class="reference internal" href="visual.html#module-visual" title="visual"><tt class="xref py py-mod docutils literal"><span class="pre">Fonts</span></tt></a></li>
<li><tt class="xref py py-mod docutils literal"><span class="pre">Useful</span> <span class="pre">Blocks</span></tt></li>
</ul>
<p>Return to the <a class="reference internal" href="tutorial.html"><em>Tutorials</em></a> page for more advanced tutorial topics.</p>
</div>
<div class="section" id="resources">
<h2><a class="toc-backref" href="#id9">Resources</a><a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h2>
<p>Here are the graphics, sounds and fonts needed for the game: <a class="reference external" href="_static/snake-tutorial.zip">zipfile</a></p>
</div>
<div class="section" id="credits">
<h2><a class="toc-backref" href="#id10">Credits</a><a class="headerlink" href="#credits" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://www.freesound.org/people/Greencouch/sounds/124909">http://www.freesound.org/people/Greencouch/sounds/124909</a></li>
<li><a class="reference external" href="http://www.freesound.org/people/suonho/sounds/3375">http://www.freesound.org/people/suonho/sounds/3375</a></li>
<li><a class="reference external" href="http://openfontlibrary.org/en/font/press-start-2p">http://openfontlibrary.org/en/font/press-start-2p</a></li>
<li><a class="reference external" href="http://openfontlibrary.org/en/font/medievalsharp">http://openfontlibrary.org/en/font/medievalsharp</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial 2: Snake Part 2</a><ul>
<li><a class="reference internal" href="#adding-sprites">Adding Sprites</a></li>
<li><a class="reference internal" href="#adding-sound">Adding Sound</a></li>
<li><a class="reference internal" href="#adding-fonts">Adding Fonts</a></li>
<li><a class="reference internal" href="#additional-gameplay-elements">Additional Gameplay elements</a></li>
<li><a class="reference internal" href="#events">Events</a></li>
<li><a class="reference internal" href="#animation">Animation</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
<li><a class="reference internal" href="#resources">Resources</a></li>
<li><a class="reference internal" href="#credits">Credits</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tutorial-1.html"
                        title="previous chapter">Tutorial 1: Snake Part 1</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="usefulblocks.html"
                        title="next chapter">Useful Building Blocks</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="usefulblocks.html" title="Useful Building Blocks"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial-1.html" title="Tutorial 1: Snake Part 1"
             >previous</a> |</li>
        <li><a href="index.html">serge 0.4.1.3 documentation</a> &raquo;</li>
          <li><a href="tutorial.html" >Tutorials</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Paul Paterson.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>